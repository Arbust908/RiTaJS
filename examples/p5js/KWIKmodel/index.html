<html>

<head>
  <title>KWIKmodel (p5js)</title>
  <script src="../../lib/p5.min.js"></script>
  <script src="../../lib/p5.dom.js"></script>
  <script src="../../../dist/rita.js"></script>
  <script>
    // TODO: add a message if the word is not found

    var word = 'window',
      data, kwic;

    function preload() {
      data = loadStrings('../../data/kafka.txt');
    }

    function setup() {

      createCanvas(600, 600);
      textFont('Times');

      input = createInput([word]);
      input.size(70);
      input.position(width / 2 - 50, 15);

      button = createButton('UPDATE');
      button.position(width / 2 + 30, 15);
      button.mousePressed(newWord);

      updateKWIC();
    }

    function updateKWIC() {

      kwic = RiTa.kwic(data.join('\n'), word, {
        ignorePunctuation: true,
        ignoreStopWords: true,
        wordCount: 6
      });

      background(250);
      fill(0);
      textSize(14);
      text('search:', 200, 21);

      textSize(18);
      var tw = textWidth(word) / 2;
      for (var i = 0; i < kwic.length; i++) {

        //console.log(display[i]);
        var parts = kwic[i].split(word);
        var x = width / 2,
          y = i * 20 + 50;

        fill(0);
        textAlign(RIGHT);
        text(parts[0], x - tw, y);

        fill(200, 0, 0);
        textAlign(CENTER);
        text(word, x, y);

        fill(0);
        textAlign(LEFT);
        text(parts[1], x + tw, y);
      }
    }

    function newWord() {
      word = input.value();
      updateKWIC();
      input.value('');
    }
  </script>
</head>

</html>
